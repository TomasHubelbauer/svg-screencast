<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>SVG Screencast</title>
    <style>
      html {
        height: 100%;
      }

      body {
        /* Prevent transparent screenshot */
        background: white;
        display: flex;
        flex-direction: column;
        height: 100%;
        margin: 0;
      }

      textarea {
        flex: 1;
        font: normal 12pt monospace;
        margin: 1em;
        outline: none;
      }
    </style>
    <script>
      let cursor = 0;
      window.addEventListener('load', async () => {
        const content = `SVG Screencast\n\nThis is an SVG image with CSS animations revealing damage region change patches producing an animation!\n\nTomas Hubelbauer\n`;

        const showcaseTextArea = document.getElementById('showcaseTextArea');
        showcaseTextArea.focus();
        showcaseTextArea.select();

        do {
          showcaseTextArea.textContent += content[cursor++];
          showcaseTextArea.setSelectionRange(showcaseTextArea.textContent.length - 1, showcaseTextArea.textContent.length);

          // Wait a random about of time between 10 and 30 ms for fluidity
          await new Promise(resolve => window.setTimeout(resolve, 10 + Math.random() * 20));
        }
        while (cursor < content.length);

        // Close after a delay to make sure to capture the final state fully
        await new Promise(resolve => window.setTimeout(resolve, 25));
        window.close();
      });
    </script>
  </head>
  <body>
    <textarea id="showcaseTextArea"></textarea>
  </body>
</html>
